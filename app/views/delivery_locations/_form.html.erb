<%= form_with(model: delivery_location, local: true, html: { class: 'h-adr' }) do |form| %>
  <% if delivery_location.errors.any? %>
    <div class="alert alert-danger">
      <h4><%= pluralize(delivery_location.errors.count, "error") %> 保存できませんでした:</h4>
      <ul>
        <% delivery_location.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <span class="p-country-name d-none">Japan</span>

  <div class="row mb-3">
    <div class="col-md-3">
      <%= form.label :customer_code, '顧客コード', class: 'form-label' %>
      <%= text_field_tag :customer_code, @customer_code, class: 'form-control', id: 'delivery_location_customer_code', placeholder: '顧客コードを入力' %>
    </div>

    <div class="col-md-9">
      <%= form.label :customer_id, class: 'form-label mb-2' do %>
        顧客名<span class="text-danger">*</span>
      <% end %>
      <%= form.hidden_field :customer_id, id: 'delivery_location_customer_id' %>
      <select id="delivery_location_customer_select" name="delivery_location[customer_id]" class="form-select" required>
        <option value="">選択してください</option>
        <% (@customers || Customer.order(:company_name)).each do |customer| %>
          <option value="<%= customer.id %>" data-customer-code="<%= customer.customer_code %>" <%= 'selected' if delivery_location.customer_id == customer.id %>>
            <%= customer.company_name %>
          </option>
        <% end %>
      </select>
    </div>
  </div>

  <div class="mb-3">
    <%= form.label :name, '納品先名', class: 'form-label' %>
    <%= form.text_field :name, class: 'form-control' %>
  </div>

  <div class="row mb-3">
    <div class="col-md-3">
      <%= form.label :postal_code, '郵便番号', class: 'form-label' %>
      <%= form.text_field :postal_code, class: 'form-control p-postal-code', placeholder: '123-4567' %>
    </div>

    <div class="col-md-9">
      <%= form.label :address, '住所', class: 'form-label' %>
      <%= form.text_field :address, class: 'form-control p-region p-locality p-street-address' %>
    </div>
  </div>

  <div class="mb-3">
    <%= form.label :phone, '電話番号', class: 'form-label' %>
    <%= form.text_field :phone, class: 'form-control', placeholder: '03-1234-5678' %>
  </div>

  <div class="mb-3">
    <%= form.label :contact_person, '担当者名', class: 'form-label' %>
    <%= form.text_field :contact_person, class: 'form-control' %>
  </div>

  <div class="mb-3">
    <%= form.submit '保存', class: 'btn btn-primary me-2' %>
    <%= link_to 'キャンセル', delivery_locations_path, class: 'btn btn-secondary' %>
  </div>
<% end %>

<%= javascript_include_tag "delivery_locations/form" %>